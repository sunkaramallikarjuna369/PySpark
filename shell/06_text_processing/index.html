<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Processing - Shell Scripting Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo">
                <svg class="logo-icon" viewBox="0 0 40 40" fill="none">
                    <rect width="40" height="40" rx="8" fill="#e25a1c"/>
                    <path d="M12 20L20 12L28 20L20 28L12 20Z" fill="white"/>
                    <circle cx="20" cy="20" r="4" fill="#e25a1c"/>
                </svg>
                <span>Data Engineering Hub</span>
            </a>
            <nav class="nav">
                <a href="../../index.html#shell" class="nav-link active">Shell</a>
                <button class="theme-toggle">&#127769;</button>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="section">
            <h1>Text Processing</h1>
            <p>Master powerful text processing tools like grep, sed, awk, and cut for data transformation and analysis in shell scripts.</p>

            <h2>3D Visualization</h2>
            <div id="visualization" class="visualization-container"></div>

            <h2>Code Examples</h2>

            <div class="tabs">
                <button class="tab active" data-tab="grep">grep</button>
                <button class="tab" data-tab="sed">sed</button>
                <button class="tab" data-tab="awk">awk</button>
                <button class="tab" data-tab="cut">cut & sort</button>
            </div>

            <div class="tab-contents">
                <div id="grep" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header">
                            <span class="code-language">Bash</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-block">
<pre>#!/bin/bash
# ============================================
# GREP - PATTERN SEARCHING
# ============================================

# Basic search
grep "pattern" file.txt
grep "error" /var/log/syslog

# Case insensitive
grep -i "error" file.txt

# Recursive search
grep -r "TODO" ./src/

# Show line numbers
grep -n "pattern" file.txt

# Count matches
grep -c "error" log.txt

# Invert match (exclude)
grep -v "debug" log.txt

# Show context
grep -B 2 "error" log.txt  # 2 lines before
grep -A 2 "error" log.txt  # 2 lines after
grep -C 2 "error" log.txt  # 2 lines around

# Multiple patterns
grep -E "error|warning|critical" log.txt
grep -e "error" -e "warning" log.txt

# Regex patterns
grep "^Start" file.txt      # Lines starting with
grep "end$" file.txt        # Lines ending with
grep "^$" file.txt          # Empty lines
grep -E "[0-9]{3}-[0-9]{4}" file.txt  # Phone pattern

# Files only
grep -l "pattern" *.txt     # Files with match
grep -L "pattern" *.txt     # Files without match

# Word boundary
grep -w "error" log.txt     # Whole word only

# Fixed string (no regex)
grep -F "special.chars[0]" file.txt

# Practical examples
# Find IP addresses
grep -oE "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b" access.log

# Find email addresses
grep -oE "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" file.txt

# Count unique errors
grep "ERROR" log.txt | sort | uniq -c | sort -rn</pre>
                        </div>
                    </div>
                </div>

                <div id="sed" class="tab-content">
                    <div class="code-container">
                        <div class="code-header">
                            <span class="code-language">Bash</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-block">
<pre>#!/bin/bash
# ============================================
# SED - STREAM EDITOR
# ============================================

# Basic substitution
sed 's/old/new/' file.txt        # First occurrence
sed 's/old/new/g' file.txt       # All occurrences
sed 's/old/new/gi' file.txt      # Case insensitive

# In-place editing
sed -i 's/old/new/g' file.txt
sed -i.bak 's/old/new/g' file.txt  # With backup

# Delete lines
sed '/pattern/d' file.txt        # Lines matching pattern
sed '5d' file.txt                # Line 5
sed '5,10d' file.txt             # Lines 5-10
sed '/^$/d' file.txt             # Empty lines
sed '/^#/d' file.txt             # Comment lines

# Print specific lines
sed -n '5p' file.txt             # Line 5
sed -n '5,10p' file.txt          # Lines 5-10
sed -n '/pattern/p' file.txt     # Matching lines

# Insert/Append
sed '3i\New line' file.txt       # Insert before line 3
sed '3a\New line' file.txt       # Append after line 3
sed '1i\Header' file.txt         # Add header

# Multiple commands
sed -e 's/a/A/g' -e 's/b/B/g' file.txt
sed 's/a/A/g; s/b/B/g' file.txt

# Using different delimiter
sed 's|/path/old|/path/new|g' file.txt
sed 's#old#new#g' file.txt

# Capture groups
sed 's/\(.*\)@\(.*\)/User: \1, Domain: \2/' emails.txt

# Practical examples
# Remove leading/trailing whitespace
sed 's/^[ \t]*//;s/[ \t]*$//' file.txt

# Convert CSV delimiter
sed 's/,/|/g' file.csv

# Add line numbers
sed = file.txt | sed 'N;s/\n/\t/'

# Extract between patterns
sed -n '/START/,/END/p' file.txt</pre>
                        </div>
                    </div>
                </div>

                <div id="awk" class="tab-content">
                    <div class="code-container">
                        <div class="code-header">
                            <span class="code-language">Bash</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-block">
<pre>#!/bin/bash
# ============================================
# AWK - PATTERN SCANNING AND PROCESSING
# ============================================

# Print columns
awk '{print $1}' file.txt        # First column
awk '{print $1, $3}' file.txt    # Columns 1 and 3
awk '{print $NF}' file.txt       # Last column
awk '{print $(NF-1)}' file.txt   # Second to last

# Custom delimiter
awk -F',' '{print $1, $2}' file.csv
awk -F':' '{print $1}' /etc/passwd

# Conditions
awk '$3 > 100' file.txt          # Where column 3 > 100
awk '$1 == "John"' file.txt      # Where column 1 is John
awk 'NR > 1' file.txt            # Skip header
awk 'NR >= 5 && NR <= 10' file.txt  # Lines 5-10

# Built-in variables
# NR = Record number (line number)
# NF = Number of fields
# FS = Field separator
# OFS = Output field separator

# Calculations
awk '{sum += $3} END {print sum}' file.txt
awk '{sum += $3; count++} END {print sum/count}' file.txt

# Formatted output
awk '{printf "%-10s %5d\n", $1, $2}' file.txt

# BEGIN and END blocks
awk 'BEGIN {print "Header"} {print $0} END {print "Footer"}' file.txt

# Multiple conditions
awk '$3 > 100 && $4 == "active" {print $1}' file.txt

# Practical examples
# Sum column in CSV
awk -F',' 'NR>1 {sum+=$3} END {print "Total:", sum}' data.csv

# Count by category
awk -F',' 'NR>1 {count[$2]++} END {for (c in count) print c, count[c]}' data.csv

# Find max value
awk -F',' 'NR>1 && $3>max {max=$3; name=$1} END {print name, max}' data.csv

# Join fields
awk -F',' '{print $1 "-" $2 "-" $3}' file.csv

# Filter and transform
awk -F',' 'NR>1 && $4>1000 {printf "%s: $%.2f\n", $1, $4}' sales.csv</pre>
                        </div>
                    </div>
                </div>

                <div id="cut" class="tab-content">
                    <div class="code-container">
                        <div class="code-header">
                            <span class="code-language">Bash</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-block">
<pre>#!/bin/bash
# ============================================
# CUT, SORT, UNIQ, AND MORE
# ============================================

# CUT - Extract columns
cut -d',' -f1 file.csv           # Field 1
cut -d',' -f1,3 file.csv         # Fields 1 and 3
cut -d',' -f2-4 file.csv         # Fields 2-4
cut -c1-10 file.txt              # Characters 1-10

# SORT
sort file.txt                    # Alphabetical
sort -n file.txt                 # Numeric
sort -r file.txt                 # Reverse
sort -k2 file.txt                # By column 2
sort -t',' -k3 -n file.csv       # CSV by column 3 numeric
sort -u file.txt                 # Unique only

# UNIQ (requires sorted input)
sort file.txt | uniq             # Remove duplicates
sort file.txt | uniq -c          # Count occurrences
sort file.txt | uniq -d          # Show only duplicates
sort file.txt | uniq -u          # Show only unique

# TR - Translate characters
tr 'a-z' 'A-Z' < file.txt        # Uppercase
tr -d '\r' < file.txt            # Remove carriage returns
tr -s ' ' < file.txt             # Squeeze spaces
tr ',' '\t' < file.csv           # CSV to TSV

# PASTE - Merge files
paste file1.txt file2.txt        # Side by side
paste -d',' file1.txt file2.txt  # With delimiter

# JOIN - Join files on common field
join -t',' file1.csv file2.csv

# WC - Word count
wc -l file.txt                   # Lines
wc -w file.txt                   # Words
wc -c file.txt                   # Bytes

# PRACTICAL PIPELINES
# Top 10 most common values
cut -d',' -f2 data.csv | sort | uniq -c | sort -rn | head -10

# Unique values in column
cut -d',' -f3 data.csv | sort -u

# Sum column values
cut -d',' -f4 data.csv | tail -n +2 | paste -sd+ | bc

# Data profiling
echo "Records: $(wc -l < data.csv)"
echo "Columns: $(head -1 data.csv | tr ',' '\n' | wc -l)"
echo "Unique in col2: $(cut -d',' -f2 data.csv | sort -u | wc -l)"</pre>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                <a href="../05_file_operations/index.html" style="color: var(--text-muted);">&larr; Previous: File Operations</a>
                <a href="../07_data_pipeline_scripts/index.html" style="color: var(--accent-primary);">Next: Data Pipeline Scripts &rarr;</a>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container footer-content">
            <p style="margin: 0; color: var(--text-muted);">PySpark & Data Engineering Learning Hub</p>
        </div>
    </footer>

    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', {
                backgroundColor: document.documentElement.getAttribute('data-theme') === 'dark' ? 0x1a1a2e : 0xf8f9fa,
                cameraPosition: { x: 6, y: 4, z: 6 }
            });
            
            // Text processing pipeline
            const tools = [
                { name: 'grep', color: 0x4dabf7, x: -2 },
                { name: 'sed', color: 0xe25a1c, x: 0 },
                { name: 'awk', color: 0x198754, x: 2 }
            ];
            
            tools.forEach((t, i) => {
                viz.createDataNode({ type: 'cylinder', size: 0.5, color: t.color, position: { x: t.x, y: 0.5, z: 0 } });
                viz.createLabel(t.name, { x: t.x, y: 1.3, z: 0 });
                if (i < tools.length - 1) {
                    viz.createArrow({ x: t.x + 0.6, y: 0.5, z: 0 }, { x: t.x + 1.4, y: 0.5, z: 0 }, { color: 0x888888 });
                }
            });
            
            viz.createLabel('Text Processing Pipeline', { x: 0, y: -1, z: 0 });
            viz.createGrid(10, 10);
        });
    </script>
</body>
</html>
