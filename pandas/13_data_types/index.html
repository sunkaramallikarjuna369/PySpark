<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Types - Pandas Learning Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo"><span>Data Engineering Hub</span></a>
            <nav class="nav"><a href="../../index.html#pandas" class="nav-link active">Pandas</a><button class="theme-toggle">ðŸŒ™</button></nav>
        </div>
    </header>
    <main class="container">
        <section class="section">
            <h1>Data Types</h1>
            <p>Understanding and managing data types is essential for memory efficiency and correct operations. Pandas supports various dtypes including numeric, string, datetime, and categorical.</p>
            <div id="visualization" class="visualization-container"></div>
            <div class="visualization-controls">
                <button class="viz-btn" onclick="showTypes()">Data Types</button>
                <button class="viz-btn" onclick="showConversion()">Conversion</button>
            </div>
            <h2>Code Examples</h2>
            <div class="tabs">
                <button class="tab active" data-tab="inspect">Inspect</button>
                <button class="tab" data-tab="convert">Convert</button>
                <button class="tab" data-tab="categorical">Categorical</button>
            </div>
            <div class="tab-contents">
                <div id="inspect" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>import pandas as pd
import numpy as np

df = pd.DataFrame({
    'int_col': [1, 2, 3],
    'float_col': [1.1, 2.2, 3.3],
    'str_col': ['a', 'b', 'c'],
    'bool_col': [True, False, True],
    'date_col': pd.date_range('2023-01-01', periods=3)
})

# Check dtypes
print("Data types:")
print(df.dtypes)

# Info with memory usage
print("\nDataFrame info:")
df.info(memory_usage='deep')

# Memory usage per column
print("\nMemory usage (bytes):")
print(df.memory_usage(deep=True))

# Check specific dtype
print(f"\nint_col dtype: {df['int_col'].dtype}")
print(f"Is numeric: {pd.api.types.is_numeric_dtype(df['int_col'])}")
print(f"Is string: {pd.api.types.is_string_dtype(df['str_col'])}")

# Select by dtype
print("\nSelect numeric columns:")
print(df.select_dtypes(include=['number']))

print("\nSelect object columns:")
print(df.select_dtypes(include=['object']))</pre>
                        </div>
                    </div>
                </div>
                <div id="convert" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>import pandas as pd
import numpy as np

df = pd.DataFrame({
    'A': ['1', '2', '3'],
    'B': ['1.1', '2.2', '3.3'],
    'C': ['2023-01-01', '2023-01-02', '2023-01-03']
})

print("Original dtypes:")
print(df.dtypes)

# Convert to numeric
df['A'] = pd.to_numeric(df['A'])
df['B'] = pd.to_numeric(df['B'])
print("\nAfter to_numeric:")
print(df.dtypes)

# Convert to datetime
df['C'] = pd.to_datetime(df['C'])
print("\nAfter to_datetime:")
print(df.dtypes)

# astype conversion
df2 = pd.DataFrame({'X': [1, 2, 3]})
df2['X'] = df2['X'].astype('float64')
print("\nUsing astype:")
print(df2.dtypes)

# Convert multiple columns
df3 = pd.DataFrame({'A': ['1', '2'], 'B': ['3', '4']})
df3 = df3.astype({'A': 'int64', 'B': 'float64'})
print("\nMultiple conversions:")
print(df3.dtypes)

# Handle errors in conversion
df4 = pd.DataFrame({'A': ['1', '2', 'invalid']})
print("\nWith errors='coerce':")
print(pd.to_numeric(df4['A'], errors='coerce'))

# Downcast for memory efficiency
df5 = pd.DataFrame({'A': [1, 2, 3]})
df5['A'] = pd.to_numeric(df5['A'], downcast='integer')
print(f"\nDowncast dtype: {df5['A'].dtype}")</pre>
                        </div>
                    </div>
                </div>
                <div id="categorical" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>import pandas as pd

# Create categorical
df = pd.DataFrame({
    'grade': ['A', 'B', 'A', 'C', 'B', 'A'],
    'size': ['S', 'M', 'L', 'M', 'S', 'L']
})

print("Original memory:")
print(df.memory_usage(deep=True))

# Convert to categorical
df['grade'] = df['grade'].astype('category')
df['size'] = pd.Categorical(df['size'], categories=['S', 'M', 'L'], ordered=True)

print("\nAfter categorical conversion:")
print(df.dtypes)
print("\nMemory after categorical:")
print(df.memory_usage(deep=True))

# Categorical properties
print("\nCategories:")
print(df['grade'].cat.categories)

print("\nCodes (integer representation):")
print(df['grade'].cat.codes)

# Ordered categorical operations
print("\nSize > 'S':")
print(df[df['size'] > 'S'])

# Add/remove categories
df['grade'] = df['grade'].cat.add_categories(['D', 'F'])
print("\nAfter adding categories:")
print(df['grade'].cat.categories)

# Rename categories
df['grade'] = df['grade'].cat.rename_categories({'A': 'Excellent', 'B': 'Good', 'C': 'Fair'})
print("\nRenamed categories:")
print(df['grade'].unique())</pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', { cameraPosition: { x: 5, y: 3, z: 5 } });
            showTypes();
        });
        function showTypes() {
            viz.clear();
            const types = [
                { label: 'int64', color: 0xe25a1c },
                { label: 'float64', color: 0x4dabf7 },
                { label: 'object', color: 0x198754 },
                { label: 'datetime', color: 0x8b5cf6 }
            ];
            types.forEach((t, i) => {
                viz.createDataNode({ type: 'cube', size: 0.5, color: t.color, position: { x: -1.5 + i * 1, y: 0.5, z: 0 } });
                viz.createLabel(t.label, { x: -1.5 + i * 1, y: 1.3, z: 0 });
            });
            viz.createLabel('Pandas Data Types', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
        function showConversion() {
            viz.clear();
            viz.createDataNode({ type: 'cube', size: 0.6, color: 0x4dabf7, position: { x: -1.5, y: 0.5, z: 0 } });
            viz.createLabel('string', { x: -1.5, y: 1.3, z: 0 });
            viz.createArrow({ x: -0.8, y: 0.5, z: 0 }, { x: 0.8, y: 0.5, z: 0 }, { color: 0x888888 });
            viz.createDataNode({ type: 'cube', size: 0.6, color: 0xe25a1c, position: { x: 1.5, y: 0.5, z: 0 } });
            viz.createLabel('int64', { x: 1.5, y: 1.3, z: 0 });
            viz.createLabel('Type Conversion', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
    </script>
</body>
</html>
