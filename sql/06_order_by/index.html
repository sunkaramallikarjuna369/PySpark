<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORDER BY - SQL Learning Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo"><span>Data Engineering Hub</span></a>
            <nav class="nav"><a href="../../index.html#sql" class="nav-link active">SQL</a><button class="theme-toggle">ðŸŒ™</button></nav>
        </div>
    </header>
    <main class="container">
        <section class="section">
            <h1>ORDER BY</h1>
            <p>ORDER BY sorts the result set by one or more columns. Learn sorting using standard SQL, PySpark DataFrame API, and PySpark SQL.</p>
            <div id="visualization" class="visualization-container"></div>
            <div class="visualization-controls">
                <button class="viz-btn" onclick="showAsc()">ASC</button>
                <button class="viz-btn" onclick="showDesc()">DESC</button>
            </div>
            <h2>Code Examples</h2>
            <div class="tabs">
                <button class="tab active" data-tab="sql">Standard SQL</button>
                <button class="tab" data-tab="pyspark-df">PySpark DataFrame</button>
                <button class="tab" data-tab="pyspark-sql">PySpark SQL</button>
                <button class="tab" data-tab="comparison">Side-by-Side</button>
            </div>
            <div class="tab-contents">
                <div id="sql" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">SQL</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>-- Ascending order (default)
SELECT * FROM employees ORDER BY salary;
SELECT * FROM employees ORDER BY salary ASC;

-- Descending order
SELECT * FROM employees ORDER BY salary DESC;

-- Multiple columns
SELECT * FROM employees ORDER BY department_id ASC, salary DESC;

-- LIMIT with ORDER BY
SELECT * FROM employees ORDER BY salary DESC LIMIT 10;

-- OFFSET for pagination
SELECT * FROM employees ORDER BY salary DESC LIMIT 10 OFFSET 20;

-- NULLS handling
SELECT * FROM employees ORDER BY commission NULLS FIRST;
SELECT * FROM employees ORDER BY commission NULLS LAST;</pre>
                        </div>
                    </div>
                </div>
                <div id="pyspark-df" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python (PySpark DataFrame API)</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>from pyspark.sql import SparkSession
from pyspark.sql.functions import col, desc, asc, asc_nulls_first, desc_nulls_last, rand

spark = SparkSession.builder.appName("OrderBy").getOrCreate()

# Create sample DataFrame
data = [
    (1, "Alice", 50000, 10, 500),
    (2, "Bob", 60000, 20, None),
    (3, "Charlie", 75000, 10, 1000),
    (4, "Diana", 55000, 20, 750)
]
df = spark.createDataFrame(data, ["id", "name", "salary", "dept_id", "commission"])

# Ascending order (default)
df.orderBy("salary").show()
df.orderBy(col("salary").asc()).show()

# Descending order
df.orderBy(col("salary").desc()).show()
df.orderBy(desc("salary")).show()

# Multiple columns
df.orderBy(col("dept_id").asc(), col("salary").desc()).show()

# LIMIT with ORDER BY
df.orderBy(col("salary").desc()).limit(10).show()

# NULLS handling
df.orderBy(asc_nulls_first("commission")).show()
df.orderBy(desc_nulls_last("commission")).show()
df.orderBy(col("commission").asc_nulls_first()).show()
df.orderBy(col("commission").desc_nulls_last()).show()

# Random order
df.orderBy(rand()).show()

# Sort (alias for orderBy)
df.sort("salary").show()
df.sort(col("salary").desc()).show()</pre>
                        </div>
                    </div>
                </div>
                <div id="pyspark-sql" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python (PySpark SQL)</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("OrderBy").getOrCreate()

# Create and register temp view
data = [
    (1, "Alice", 50000, 10, 500),
    (2, "Bob", 60000, 20, None),
    (3, "Charlie", 75000, 10, 1000),
    (4, "Diana", 55000, 20, 750)
]
df = spark.createDataFrame(data, ["id", "name", "salary", "dept_id", "commission"])
df.createOrReplaceTempView("employees")

# Ascending order
spark.sql("SELECT * FROM employees ORDER BY salary").show()
spark.sql("SELECT * FROM employees ORDER BY salary ASC").show()

# Descending order
spark.sql("SELECT * FROM employees ORDER BY salary DESC").show()

# Multiple columns
spark.sql("SELECT * FROM employees ORDER BY dept_id ASC, salary DESC").show()

# LIMIT with ORDER BY
spark.sql("SELECT * FROM employees ORDER BY salary DESC LIMIT 10").show()

# NULLS handling
spark.sql("SELECT * FROM employees ORDER BY commission NULLS FIRST").show()
spark.sql("SELECT * FROM employees ORDER BY commission NULLS LAST").show()

# Random order
spark.sql("SELECT * FROM employees ORDER BY rand()").show()</pre>
                        </div>
                    </div>
                </div>
                <div id="comparison" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Side-by-Side Comparison</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre># ============================================
# ORDER BY: DataFrame API vs SQL
# ============================================
from pyspark.sql import SparkSession
from pyspark.sql.functions import col, desc

spark = SparkSession.builder.appName("Comparison").getOrCreate()

data = [(1, "Alice", 50000), (2, "Bob", 60000), (3, "Charlie", 45000)]
df = spark.createDataFrame(data, ["id", "name", "salary"])
df.createOrReplaceTempView("employees")

# ASCENDING ORDER
# DataFrame API:
df.orderBy("salary").show()
# PySpark SQL:
spark.sql("SELECT * FROM employees ORDER BY salary").show()

# DESCENDING ORDER
# DataFrame API:
df.orderBy(col("salary").desc()).show()
# PySpark SQL:
spark.sql("SELECT * FROM employees ORDER BY salary DESC").show()

# MULTIPLE COLUMNS
# DataFrame API:
df.orderBy(col("name").asc(), col("salary").desc()).show()
# PySpark SQL:
spark.sql("SELECT * FROM employees ORDER BY name ASC, salary DESC").show()

# LIMIT
# DataFrame API:
df.orderBy(col("salary").desc()).limit(2).show()
# PySpark SQL:
spark.sql("SELECT * FROM employees ORDER BY salary DESC LIMIT 2").show()</pre>
                        </div>
                    </div>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                <a href="../05_having/index.html" style="color: var(--text-muted);">&larr; Previous: HAVING</a>
                <a href="../07_subqueries/index.html" style="color: var(--accent-primary);">Next: Subqueries &rarr;</a>
            </div>
        </section>
    </main>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', { cameraPosition: { x: 5, y: 3, z: 5 } });
            showAsc();
        });
        function showAsc() {
            viz.clear();
            for (let i = 0; i < 5; i++) {
                viz.createDataNode({ type: 'cube', size: 0.3 + i * 0.1, color: 0x4dabf7, position: { x: 0, y: 1.5 - i * 0.7, z: 0 } });
            }
            viz.createLabel('ORDER BY ASC - Smallest to largest', { x: 0, y: -2, z: 0 });
            viz.createGrid(10, 10);
        }
        function showDesc() {
            viz.clear();
            for (let i = 0; i < 5; i++) {
                viz.createDataNode({ type: 'cube', size: 0.7 - i * 0.1, color: 0xe25a1c, position: { x: 0, y: 1.5 - i * 0.7, z: 0 } });
            }
            viz.createLabel('ORDER BY DESC - Largest to smallest', { x: 0, y: -2, z: 0 });
            viz.createGrid(10, 10);
        }
    </script>
</body>
</html>
