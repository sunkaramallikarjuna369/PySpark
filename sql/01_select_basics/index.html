<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SELECT Basics - SQL Learning Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo"><span>Data Engineering Hub</span></a>
            <nav class="nav"><a href="../../index.html#sql" class="nav-link active">SQL</a><button class="theme-toggle">ðŸŒ™</button></nav>
        </div>
    </header>
    <main class="container">
        <section class="section">
            <h1>SELECT Basics</h1>
            <p>The SELECT statement is the foundation of SQL queries. Learn how to retrieve data using standard SQL, PySpark DataFrame API, and PySpark SQL.</p>
            <div id="visualization" class="visualization-container"></div>
            <div class="visualization-controls">
                <button class="viz-btn" onclick="showSelectAll()">SELECT *</button>
                <button class="viz-btn" onclick="showSelectColumns()">SELECT Columns</button>
                <button class="viz-btn" onclick="showDistinct()">DISTINCT</button>
            </div>
            <h2>Code Examples</h2>
            <div class="tabs">
                <button class="tab active" data-tab="sql">Standard SQL</button>
                <button class="tab" data-tab="pyspark-df">PySpark DataFrame</button>
                <button class="tab" data-tab="pyspark-sql">PySpark SQL</button>
                <button class="tab" data-tab="comparison">Side-by-Side</button>
            </div>
            <div class="tab-contents">
                <div id="sql" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">SQL</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>-- Select all columns from a table
SELECT * FROM employees;

-- Select specific columns
SELECT first_name, last_name, salary FROM employees;

-- Select with column alias
SELECT 
    first_name AS "First Name",
    last_name AS "Last Name",
    salary * 12 AS annual_salary
FROM employees;

-- Select distinct values
SELECT DISTINCT department_id FROM employees;

-- Count all rows
SELECT COUNT(*) FROM employees;

-- Limit results
SELECT * FROM employees LIMIT 10;

-- CASE expression in SELECT
SELECT 
    first_name,
    salary,
    CASE 
        WHEN salary > 10000 THEN 'High'
        WHEN salary > 5000 THEN 'Medium'
        ELSE 'Low'
    END AS salary_level
FROM employees;</pre>
                        </div>
                    </div>
                </div>
                <div id="pyspark-df" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python (PySpark DataFrame API)</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>from pyspark.sql import SparkSession
from pyspark.sql.functions import col, concat, lit, when, countDistinct

spark = SparkSession.builder.appName("SelectBasics").getOrCreate()

# Create sample DataFrame
data = [
    (1, "Alice", "Smith", 50000, 101),
    (2, "Bob", "Johnson", 60000, 102),
    (3, "Charlie", "Brown", 75000, 101)
]
df = spark.createDataFrame(data, ["id", "first_name", "last_name", "salary", "dept_id"])

# Select all columns
df.select("*").show()

# Select specific columns
df.select("first_name", "last_name", "salary").show()

# Select with column alias
df.select(
    col("first_name").alias("First Name"),
    col("last_name").alias("Last Name"),
    (col("salary") * 12).alias("annual_salary")
).show()

# Select distinct values
df.select("dept_id").distinct().show()

# Count all rows
print(f"Total rows: {df.count()}")

# Limit results
df.limit(10).show()

# CASE expression using when()
df.select(
    "first_name",
    "salary",
    when(col("salary") > 10000, "High")
    .when(col("salary") > 5000, "Medium")
    .otherwise("Low").alias("salary_level")
).show()</pre>
                        </div>
                    </div>
                </div>
                <div id="pyspark-sql" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python (PySpark SQL)</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("SelectBasics").getOrCreate()

# Create DataFrame and register as temp view
data = [
    (1, "Alice", "Smith", 50000, 101),
    (2, "Bob", "Johnson", 60000, 102),
    (3, "Charlie", "Brown", 75000, 101)
]
df = spark.createDataFrame(data, ["id", "first_name", "last_name", "salary", "dept_id"])
df.createOrReplaceTempView("employees")

# Select all columns
spark.sql("SELECT * FROM employees").show()

# Select specific columns
spark.sql("SELECT first_name, last_name, salary FROM employees").show()

# Select with column alias
spark.sql("""
    SELECT 
        first_name AS `First Name`,
        last_name AS `Last Name`,
        salary * 12 AS annual_salary
    FROM employees
""").show()

# Select distinct values
spark.sql("SELECT DISTINCT dept_id FROM employees").show()

# Count all rows
spark.sql("SELECT COUNT(*) AS total FROM employees").show()

# Limit results
spark.sql("SELECT * FROM employees LIMIT 10").show()

# CASE expression
spark.sql("""
    SELECT 
        first_name,
        salary,
        CASE 
            WHEN salary > 10000 THEN 'High'
            WHEN salary > 5000 THEN 'Medium'
            ELSE 'Low'
        END AS salary_level
    FROM employees
""").show()</pre>
                        </div>
                    </div>
                </div>
                <div id="comparison" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Side-by-Side Comparison</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre># ============================================
# SELECT BASICS: DataFrame API vs SQL
# ============================================
from pyspark.sql import SparkSession
from pyspark.sql.functions import col, when

spark = SparkSession.builder.appName("Comparison").getOrCreate()

# Sample data
data = [(1, "Alice", 50000), (2, "Bob", 60000), (3, "Charlie", 75000)]
df = spark.createDataFrame(data, ["id", "name", "salary"])
df.createOrReplaceTempView("employees")

# SELECT ALL
# DataFrame API:
df.select("*").show()
# PySpark SQL:
spark.sql("SELECT * FROM employees").show()

# SELECT SPECIFIC COLUMNS
# DataFrame API:
df.select("name", "salary").show()
# PySpark SQL:
spark.sql("SELECT name, salary FROM employees").show()

# SELECT WITH ALIAS
# DataFrame API:
df.select(col("name").alias("employee_name")).show()
# PySpark SQL:
spark.sql("SELECT name AS employee_name FROM employees").show()

# CALCULATED COLUMNS
# DataFrame API:
df.select("name", (col("salary") * 12).alias("annual")).show()
# PySpark SQL:
spark.sql("SELECT name, salary * 12 AS annual FROM employees").show()

# CASE/WHEN
# DataFrame API:
df.select("name", 
    when(col("salary") > 60000, "High").otherwise("Normal").alias("level")
).show()
# PySpark SQL:
spark.sql("""
    SELECT name, 
        CASE WHEN salary > 60000 THEN 'High' ELSE 'Normal' END AS level
    FROM employees
""").show()</pre>
                        </div>
                    </div>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                <span style="color: var(--text-muted);">First Topic</span>
                <a href="../02_where_filtering/index.html" style="color: var(--accent-primary);">Next: WHERE Filtering &rarr;</a>
            </div>
        </section>
    </main>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', { cameraPosition: { x: 5, y: 3, z: 5 } });
            showSelectAll();
        });
        function showSelectAll() {
            viz.clear();
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    viz.createDataNode({ type: 'cube', size: 0.4, color: 0x4dabf7, position: { x: -1.5 + j * 1, y: 1.5 - i * 0.8, z: 0 } });
                }
            }
            viz.createLabel('SELECT * - All columns selected', { x: 0, y: -2, z: 0 });
            viz.createGrid(10, 10);
        }
        function showSelectColumns() {
            viz.clear();
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    const selected = j === 0 || j === 2;
                    viz.createDataNode({ type: 'cube', size: 0.4, color: selected ? 0xe25a1c : 0x333333, position: { x: -1.5 + j * 1, y: 1.5 - i * 0.8, z: 0 } });
                }
            }
            viz.createLabel('SELECT col1, col3 - Specific columns', { x: 0, y: -2, z: 0 });
            viz.createGrid(10, 10);
        }
        function showDistinct() {
            viz.clear();
            const colors = [0xe25a1c, 0x4dabf7, 0x198754];
            for (let i = 0; i < 3; i++) {
                viz.createDataNode({ type: 'cube', size: 0.5, color: colors[i], position: { x: -1 + i * 1, y: 0.5, z: 0 } });
            }
            viz.createLabel('DISTINCT - Unique values only', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
    </script>
</body>
</html>
