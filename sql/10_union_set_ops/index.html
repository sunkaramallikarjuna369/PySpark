<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNION & Set Operations - SQL Learning Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo"><span>Data Engineering Hub</span></a>
            <nav class="nav"><a href="../../index.html#sql" class="nav-link active">SQL</a><button class="theme-toggle">ðŸŒ™</button></nav>
        </div>
    </header>
    <main class="container">
        <section class="section">
            <h1>UNION & Set Operations</h1>
            <p>Set operations combine results from multiple SELECT statements. UNION, INTERSECT, and EXCEPT are the main set operators.</p>
            <div id="visualization" class="visualization-container"></div>
            <div class="visualization-controls">
                <button class="viz-btn" onclick="showUnion()">UNION</button>
                <button class="viz-btn" onclick="showIntersect()">INTERSECT</button>
                <button class="viz-btn" onclick="showExcept()">EXCEPT</button>
            </div>
            <h2>Code Examples</h2>
            <div class="tabs">
                <button class="tab active" data-tab="union">UNION</button>
                <button class="tab" data-tab="intersect">INTERSECT & EXCEPT</button>
            </div>
            <div class="tab-contents">
                <div id="union" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">SQL</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>-- UNION (removes duplicates)
SELECT first_name, last_name FROM employees
UNION
SELECT first_name, last_name FROM contractors;

-- UNION ALL (keeps duplicates, faster)
SELECT first_name, last_name FROM employees
UNION ALL
SELECT first_name, last_name FROM contractors;

-- Multiple UNIONs
SELECT name, 'Employee' AS type FROM employees
UNION ALL
SELECT name, 'Contractor' AS type FROM contractors
UNION ALL
SELECT name, 'Intern' AS type FROM interns;

-- UNION with ORDER BY (at the end)
SELECT first_name, salary FROM employees WHERE department_id = 10
UNION
SELECT first_name, salary FROM employees WHERE department_id = 20
ORDER BY salary DESC;

-- UNION with different column names (uses first query's names)
SELECT first_name AS name, salary AS pay FROM employees
UNION
SELECT contractor_name, hourly_rate * 2080 FROM contractors;</pre>
                        </div>
                    </div>
                </div>
                <div id="intersect" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">SQL</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>-- INTERSECT (rows in both queries)
SELECT employee_id FROM employees
INTERSECT
SELECT employee_id FROM project_assignments;

-- INTERSECT ALL (keeps duplicates)
SELECT skill FROM employee_skills
INTERSECT ALL
SELECT skill FROM required_skills;

-- EXCEPT / MINUS (rows in first but not second)
SELECT employee_id FROM employees
EXCEPT
SELECT employee_id FROM terminated_employees;

-- EXCEPT ALL
SELECT product_id FROM inventory
EXCEPT ALL
SELECT product_id FROM sold_items;

-- Combining set operations
(SELECT id FROM table_a
 UNION
 SELECT id FROM table_b)
INTERSECT
SELECT id FROM table_c;

-- Using set operations for data comparison
-- Find new customers (in current but not previous)
SELECT customer_id FROM current_customers
EXCEPT
SELECT customer_id FROM previous_customers;

-- Find churned customers (in previous but not current)
SELECT customer_id FROM previous_customers
EXCEPT
SELECT customer_id FROM current_customers;</pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', { cameraPosition: { x: 5, y: 3, z: 5 } });
            showUnion();
        });
        function showUnion() {
            viz.clear();
            viz.createDataNode({ type: 'sphere', size: 0.8, color: 0x4dabf7, position: { x: -0.5, y: 0.5, z: 0 } });
            viz.createDataNode({ type: 'sphere', size: 0.8, color: 0xe25a1c, position: { x: 0.5, y: 0.5, z: 0 } });
            viz.createLabel('A', { x: -1.2, y: 1.2, z: 0 });
            viz.createLabel('B', { x: 1.2, y: 1.2, z: 0 });
            viz.createLabel('UNION - All rows from both', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
        function showIntersect() {
            viz.clear();
            viz.createDataNode({ type: 'sphere', size: 0.8, color: 0x333333, position: { x: -0.5, y: 0.5, z: 0 } });
            viz.createDataNode({ type: 'sphere', size: 0.8, color: 0x333333, position: { x: 0.5, y: 0.5, z: 0 } });
            viz.createDataNode({ type: 'sphere', size: 0.4, color: 0x198754, position: { x: 0, y: 0.5, z: 0 } });
            viz.createLabel('INTERSECT - Only common rows', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
        function showExcept() {
            viz.clear();
            viz.createDataNode({ type: 'sphere', size: 0.8, color: 0xe25a1c, position: { x: -0.5, y: 0.5, z: 0 } });
            viz.createDataNode({ type: 'sphere', size: 0.8, color: 0x333333, position: { x: 0.5, y: 0.5, z: 0 } });
            viz.createLabel('EXCEPT - Rows in A but not B', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
    </script>
</body>
</html>
