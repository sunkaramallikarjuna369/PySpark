<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Warehouse Architecture - DW Learning Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo"><span>Data Engineering Hub</span></a>
            <nav class="nav"><a href="../../index.html#datawarehouse" class="nav-link active">Data Warehouse</a><button class="theme-toggle">ðŸŒ™</button></nav>
        </div>
    </header>
    <main class="container">
        <section class="section">
            <h1>Data Warehouse Architecture</h1>
            <p>A data warehouse is a centralized repository for integrated data from multiple sources, optimized for analytical queries and reporting.</p>
            <div id="visualization" class="visualization-container"></div>
            <div class="visualization-controls">
                <button class="viz-btn" onclick="showArchitecture()">Architecture</button>
                <button class="viz-btn" onclick="showLayers()">Layers</button>
            </div>
            <h2>Code Examples</h2>
            <div class="tabs">
                <button class="tab active" data-tab="concepts">Core Concepts</button>
                <button class="tab" data-tab="layers">Data Layers</button>
                <button class="tab" data-tab="modern">Modern DW</button>
            </div>
            <div class="tab-contents">
                <div id="concepts" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Text</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>Data Warehouse Characteristics (Bill Inmon):

1. SUBJECT-ORIENTED
   - Organized around major subjects (customers, products, sales)
   - Not around applications or processes
   - Provides simple, concise view of business

2. INTEGRATED
   - Data from multiple sources combined
   - Consistent naming conventions
   - Consistent data formats and encoding

3. TIME-VARIANT
   - Historical data maintained
   - Time dimension in every table
   - Supports trend analysis

4. NON-VOLATILE
   - Data is loaded and accessed, not updated
   - No operational updates or deletes
   - Stable for analysis

Key Components:
- Source Systems: OLTP databases, files, APIs
- ETL/ELT: Extract, Transform, Load processes
- Staging Area: Temporary storage for raw data
- Data Warehouse: Central repository
- Data Marts: Subject-specific subsets
- BI Tools: Reporting and visualization</pre>
                        </div>
                    </div>
                </div>
                <div id="layers" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Python</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>"""
Data Warehouse Layers (Medallion Architecture):
"""

from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("DWArchitecture").getOrCreate()

# BRONZE LAYER (Raw)
# - Raw data as-is from source
# - Minimal transformation
# - Full history preserved
bronze_df = spark.read.parquet("/data/bronze/sales/")

# SILVER LAYER (Cleansed)
# - Cleaned and validated data
# - Standardized formats
# - Deduplication applied
silver_df = bronze_df \
    .dropDuplicates(["transaction_id"]) \
    .filter("amount > 0") \
    .withColumn("date", to_date("timestamp"))

silver_df.write.format("delta").save("/data/silver/sales/")

# GOLD LAYER (Business)
# - Business-level aggregations
# - Ready for reporting
# - Optimized for queries
gold_df = spark.sql("""
    SELECT 
        date,
        product_category,
        SUM(amount) as total_sales,
        COUNT(*) as transaction_count
    FROM silver_sales
    GROUP BY date, product_category
""")

gold_df.write.format("delta").save("/data/gold/sales_summary/")

# Layer Characteristics:
# Bronze: Raw, append-only, schema-on-read
# Silver: Cleaned, validated, schema-on-write
# Gold: Aggregated, business-ready, optimized</pre>
                        </div>
                    </div>
                </div>
                <div id="modern" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Text</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>Modern Data Warehouse Platforms:

CLOUD DATA WAREHOUSES:
1. Snowflake
   - Separation of storage and compute
   - Auto-scaling, pay-per-use
   - Multi-cloud support

2. Google BigQuery
   - Serverless, fully managed
   - Built-in ML capabilities
   - Streaming ingestion

3. Amazon Redshift
   - Columnar storage
   - Massively parallel processing
   - Integration with AWS ecosystem

4. Azure Synapse Analytics
   - Unified analytics platform
   - Serverless and dedicated options
   - Integration with Power BI

DATA LAKEHOUSE:
- Combines data lake and warehouse
- ACID transactions on data lake
- Open formats (Delta, Iceberg, Hudi)
- Schema enforcement and evolution
- Examples: Databricks, Delta Lake

Architecture Evolution:
Traditional DW -> Cloud DW -> Data Lakehouse

Key Trends:
- Separation of storage and compute
- Real-time/streaming capabilities
- Self-service analytics
- Data mesh / decentralized ownership</pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', { cameraPosition: { x: 5, y: 3, z: 5 } });
            showArchitecture();
        });
        function showArchitecture() {
            viz.clear();
            // Sources
            for (let i = 0; i < 3; i++) {
                viz.createDataNode({ type: 'cylinder', size: 0.35, color: 0x4dabf7, position: { x: -2.5, y: 1 - i * 0.8, z: 0 } });
            }
            viz.createLabel('Sources', { x: -2.5, y: 1.8, z: 0 });
            // ETL
            viz.createDataNode({ type: 'cube', size: 0.5, color: 0xe25a1c, position: { x: -0.8, y: 0.5, z: 0 } });
            viz.createLabel('ETL', { x: -0.8, y: 1.3, z: 0 });
            // DW
            viz.createDataNode({ type: 'cylinder', size: 0.7, color: 0x198754, position: { x: 1, y: 0.5, z: 0 } });
            viz.createLabel('DW', { x: 1, y: 1.5, z: 0 });
            // BI
            viz.createDataNode({ type: 'cube', size: 0.4, color: 0x8b5cf6, position: { x: 2.5, y: 0.5, z: 0 } });
            viz.createLabel('BI', { x: 2.5, y: 1.2, z: 0 });
            // Arrows
            viz.createArrow({ x: -2, y: 0.5, z: 0 }, { x: -1.3, y: 0.5, z: 0 }, { color: 0x888888 });
            viz.createArrow({ x: -0.3, y: 0.5, z: 0 }, { x: 0.4, y: 0.5, z: 0 }, { color: 0x888888 });
            viz.createArrow({ x: 1.6, y: 0.5, z: 0 }, { x: 2.1, y: 0.5, z: 0 }, { color: 0x888888 });
            viz.createLabel('Data Warehouse Architecture', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
        function showLayers() {
            viz.clear();
            const layers = [
                { name: 'Bronze', color: 0xcd7f32, y: 0 },
                { name: 'Silver', color: 0xc0c0c0, y: 0.8 },
                { name: 'Gold', color: 0xffd700, y: 1.6 }
            ];
            layers.forEach(l => {
                viz.createDataNode({ type: 'cube', size: 0.6, color: l.color, position: { x: 0, y: l.y, z: 0 } });
                viz.createLabel(l.name, { x: 1.2, y: l.y, z: 0 });
            });
            viz.createLabel('Medallion Architecture', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
    </script>
</body>
</html>
