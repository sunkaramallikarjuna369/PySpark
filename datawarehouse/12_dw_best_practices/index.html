<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DW Best Practices - DW Learning Hub</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="../../index.html" class="logo"><span>Data Engineering Hub</span></a>
            <nav class="nav"><a href="../../index.html#datawarehouse" class="nav-link active">Data Warehouse</a><button class="theme-toggle">ðŸŒ™</button></nav>
        </div>
    </header>
    <main class="container">
        <section class="section">
            <h1>Data Warehouse Best Practices</h1>
            <p>Following best practices ensures your data warehouse is reliable, performant, maintainable, and delivers business value.</p>
            <div id="visualization" class="visualization-container"></div>
            <div class="visualization-controls">
                <button class="viz-btn" onclick="showPillars()">Pillars</button>
                <button class="viz-btn" onclick="showChecklist()">Checklist</button>
            </div>
            <h2>Code Examples</h2>
            <div class="tabs">
                <button class="tab active" data-tab="design">Design</button>
                <button class="tab" data-tab="performance">Performance</button>
                <button class="tab" data-tab="governance">Governance</button>
            </div>
            <div class="tab-contents">
                <div id="design" class="tab-content active">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Text</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>Data Warehouse Design Best Practices:

1. DEFINE CLEAR GRAIN
   - Most important design decision
   - One row represents what exactly?
   - Document grain for every fact table
   - Don't mix grains in same fact

2. USE SURROGATE KEYS
   - Integer surrogate keys for dimensions
   - Keep natural keys as attributes
   - Handle unknown members (-1)
   - Enable SCD Type 2

3. CONFORM DIMENSIONS
   - Share dimensions across facts
   - Use bus matrix for planning
   - Consistent definitions enterprise-wide
   - Enable drill-across queries

4. DESIGN FOR CHANGE
   - Plan for SCD from the start
   - Use effective/expiration dates
   - Version dimension records
   - Document change history

5. SEPARATE CONCERNS
   - Staging area for raw data
   - Integration layer for cleansing
   - Presentation layer for reporting
   - Clear data flow between layers

6. DOCUMENT EVERYTHING
   - Data dictionary
   - Business rules
   - ETL logic
   - Data lineage</pre>
                        </div>
                    </div>
                </div>
                <div id="performance" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">SQL</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>-- Performance Best Practices

-- 1. PARTITIONING
-- Partition fact tables by date
CREATE TABLE fact_sales (
    date_key INT,
    product_key INT,
    amount DECIMAL(12,2)
)
PARTITIONED BY (year INT, month INT);

-- Query with partition pruning
SELECT SUM(amount) FROM fact_sales
WHERE year = 2024 AND month = 1;  -- Only scans Jan 2024

-- 2. INDEXING
-- Index dimension keys and common filter columns
CREATE INDEX idx_customer_segment ON dim_customer(segment);
CREATE INDEX idx_product_category ON dim_product(category);

-- 3. AGGREGATION TABLES
-- Pre-compute common aggregations
CREATE TABLE agg_sales_monthly AS
SELECT 
    year, month, product_category,
    SUM(amount) as total_sales,
    COUNT(*) as transaction_count
FROM fact_sales f
JOIN dim_date d ON f.date_key = d.date_key
JOIN dim_product p ON f.product_key = p.product_key
GROUP BY year, month, product_category;

-- 4. COLUMNAR STORAGE
-- Use columnar formats for analytics
-- Parquet, ORC, Delta Lake

-- 5. STATISTICS
-- Keep statistics updated for query optimizer
ANALYZE TABLE fact_sales COMPUTE STATISTICS;
ANALYZE TABLE dim_customer COMPUTE STATISTICS FOR ALL COLUMNS;

-- 6. QUERY OPTIMIZATION
-- Use EXPLAIN to understand query plans
EXPLAIN SELECT ... FROM fact_sales ...;</pre>
                        </div>
                    </div>
                </div>
                <div id="governance" class="tab-content">
                    <div class="code-container">
                        <div class="code-header"><span class="code-language">Text</span><button class="copy-btn">Copy</button></div>
                        <div class="code-block">
<pre>Data Governance Best Practices:

1. DATA QUALITY
   - Define quality rules
   - Implement validation checks
   - Monitor quality metrics
   - Alert on quality issues
   - Track quality over time

2. DATA SECURITY
   - Role-based access control
   - Column-level security for PII
   - Row-level security for multi-tenant
   - Encryption at rest and in transit
   - Audit logging

3. DATA LINEAGE
   - Track data from source to report
   - Document transformations
   - Enable impact analysis
   - Support compliance requirements

4. METADATA MANAGEMENT
   - Business glossary
   - Technical metadata
   - Operational metadata
   - Data catalog

5. CHANGE MANAGEMENT
   - Version control for ETL code
   - Schema change procedures
   - Testing environments
   - Rollback procedures

6. MONITORING & ALERTING
   - ETL job monitoring
   - Data freshness tracking
   - Performance monitoring
   - Capacity planning

7. DOCUMENTATION
   - Data dictionary
   - Business rules
   - SLA definitions
   - Runbooks</pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/visualization.js"></script>
    <script>
        let viz;
        document.addEventListener('DOMContentLoaded', function() {
            viz = new DataVisualization('visualization', { cameraPosition: { x: 5, y: 3, z: 5 } });
            showPillars();
        });
        function showPillars() {
            viz.clear();
            const pillars = [
                { name: 'Design', color: 0x4dabf7 },
                { name: 'Performance', color: 0xe25a1c },
                { name: 'Quality', color: 0x198754 },
                { name: 'Governance', color: 0x8b5cf6 }
            ];
            pillars.forEach((p, i) => {
                viz.createDataNode({ type: 'cube', size: 0.5, color: p.color, position: { x: -1.5 + i, y: 0.5, z: 0 } });
                viz.createLabel(p.name, { x: -1.5 + i, y: 1.3, z: 0 });
            });
            viz.createLabel('DW Best Practice Pillars', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
        function showChecklist() {
            viz.clear();
            const items = ['Grain Defined', 'Surrogate Keys', 'Conformed Dims', 'Documented', 'Monitored'];
            items.forEach((item, i) => {
                viz.createDataNode({ type: 'cube', size: 0.3, color: 0x198754, position: { x: -0.5, y: 1.2 - i * 0.5, z: 0 } });
                viz.createLabel(item, { x: 0.8, y: 1.2 - i * 0.5, z: 0 });
            });
            viz.createLabel('DW Design Checklist', { x: 0, y: -1.5, z: 0 });
            viz.createGrid(10, 10);
        }
    </script>
</body>
</html>
